// This file has been autogenerated from a class added in the UI designer.

using System;

using Foundation;
using PorpoiseMobileApp.ViewModels;
using UIKit;

namespace PorpoiseMobileApp.iOS
{
	public partial class AccountSettingsViewController : MvvmViewController<AccountSettingsViewModel>
	{
		public AccountSettingsViewController(IntPtr handle) : base(handle)
		{
		}


		public override void ViewDidLoad()
		{
			base.ViewDidLoad();
			this.View.BackgroundColor = PorpoiseColors.Turquoise;
			if (this.NavigationController != null)
		
				if (this.NavigationController != null)
				{
					//TODO: figure out how to make the status bar opaque.


					this.NavigationController.NavigationBar.BarStyle = UIBarStyle.BlackOpaque;
					this.NavigationController.NavigationBar.SetBackgroundImage(new UIImage(), UIBarMetrics.Default);
					this.NavigationController.NavigationBar.ShadowImage = new UIImage();
					this.NavigationController.NavigationBar.BackgroundColor = PorpoiseColors.Turquoise;
				}
				NavigationItem.RightBarButtonItem = new UIBarButtonItem(Resource.Logout, UIBarButtonItemStyle.Plain, (s, e) =>
				{
					ViewModel.Logout();
				});

				UIBarButtonItem button = new UIBarButtonItem();

				button.Image = new UIImage("logo.png");

				NavigationItem.LeftBarButtonItem = button;

				NavigationItem.Title = "Porpoise";

			float imageSize = 20f;

			float gap = 5f;

			float borderSize = 0f;

			float textHeight = 1f;

			float buttonWidth = 60;

			float buttonHeight = borderSize * 2 + gap * 3 + imageSize + textHeight;

			float imageOrigin = borderSize + gap;

			float textTop = imageOrigin + imageSize + gap;

			float textBottom = borderSize + gap;

			float imageBottom = textBottom + textHeight + gap;

			UIButton rigthButton = new UIButton();

			rigthButton.Frame = new CGRect(0, 0, buttonWidth, buttonHeight);

			rigthButton.Center = this.View.Center;

			//Image

			UIImage logout = new UIImage("logout.png");

			rigthButton.SetImage(logout, UIControlState.Normal);

			rigthButton.ImageEdgeInsets = new UIEdgeInsets(0, 15, 0, 0);

			rigthButton.SetTitle(Resource.Logout, UIControlState.Normal);

			rigthButton.TitleEdgeInsets = new UIEdgeInsets(textTop, -logout.Size.Width, textBottom, 0.0f);

			rigthButton.TitleLabel.Font = UIFont.FromName("Ubuntu-Light", 15f);

			rigthButton.TouchUpInside += delegate
			{

				ViewModel.Logout();

			};

			NavigationItem.RightBarButtonItem = new UIBarButtonItem(rigthButton);


			var url = new NSUrl(ViewModel.SettingsUrl);
			var request = new NSUrlRequest(url);
			AccountSettingsWebView.BackgroundColor = PorpoiseColors.Turquoise;
			AccountSettingsWebView.LoadRequest(request);

		}
	}
}
